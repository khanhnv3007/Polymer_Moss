<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/font-roboto/roboto.html">
<link rel="import" href="bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="bower_components/core-icons/core-icons.html">
<link rel="import" href="bower_components/paper-fab/paper-fab.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="bower_components/core-localstorage/core-localstorage.html">
<link rel="import" href="bower_components/core-item/core-item.html">
<link rel="import" href="bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="bower_components/paper-slider/paper-slider.html">
<link rel="import" href="bower_components/paper-toast/paper-toast.html">
<link rel="import" href="bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="bower_components/file-input/file-input.html">
<script src="jquery-1.11.1.js"></script>
<link rel="import" href="my-Btn.html">
<polymer-element name="moss-app">
    <template>
        <link rel="stylesheet" href="styles.css">
        <core-drawer-panel responsiveWidth="600px" id="drawerPanel" narrow="{{narrow}}">

            <core-header-panel drawer mode="waterfall">
                <core-toolbar>Choose programming language:</core-toolbar>
                <paper-radio-group id="language" selected="{{language}}">
                    <paper-radio-button label="C" value="1"></paper-radio-button>
                    <br>
                    <paper-radio-button label="C++" value="2"></paper-radio-button>
                    <br>
                    <paper-radio-button label="Java" value="3"></paper-radio-button>
                    <br>
                    <paper-radio-button label="javaScript" value="4"></paper-radio-button>
                    <br>
                    <paper-radio-button label="Python" value="5"></paper-radio-button>
                    <br>
                    <paper-radio-button label="C#" value="6"></paper-radio-button>
                    <br>
                    <paper-radio-button label="PHP" value="7"></paper-radio-button>
                    <br>
                    <paper-radio-button label="Objective-C" value="8"></paper-radio-button>
                    <br>
                    <paper-radio-button label="Perl" value="9"></paper-radio-button>
                    <br>
                    <paper-radio-button label="Matlab" value="10"></paper-radio-button>
                    <br>
                    <paper-radio-button label="TCL" value="11"></paper-radio-button>
                    <br>
                </paper-radio-group>
            </core-header-panel>

            <core-header-panel main mode="waterfall">
                <core-toolbar>
                    <paper-icon-button icon="menu" on-click="{{toggleDrawer}}"></paper-icon-button>
                    <span flex>Check Code Via Moss</span>
                    <paper-fab id="btn-upload" icon="add" on-click="{{tapSelect}}"></paper-fab>
                    <input id="input_hiden" type="file" style="display: none" name="files[]" on-change="{{handleFilePick}}" multiple></input>
                </core-toolbar>
                <div id="dropzone" on-tap="{{tapSelect}}" on-dragover="{{handleDragOver}}" on-drop="{{handleFileSelect}}">
                    Drag files which want to check
                    <ul class="filelist">
                        <template repeat="{{file in uploadList}}">
                            <li>
                                <strong>{{file.name}}</strong>&#32;{{file.type}}
                            </li>
                        </template>
                    </ul>
                </div>
            </core-header-panel>

        </core-drawer-panel>
    </template>
    <script>
    Polymer('moss-app', {
        uploadList: [], // selected files
        uploadedList: [], // successfully uploaded files
        tapSelect: function(e) {
            this.$.input_hiden.click();
        },
        handleDragOver: function(e) {
            e.stopPropagation();
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
        },
        handleFilePick: function(e) {
            e.stopPropagation();
            e.preventDefault();
            this.selectFiles(e.target.files);
        },
        handleFileSelect: function(e) {
            e.stopPropagation();
            e.preventDefault();
            this.selectFiles(e.dataTransfer.files);
        },
        clearUploadList: function() {
            this.uploadedList = [];
            this.uploadList = [];
        },
        uploadFiles: function(files) {
            var uploadedList = this.uploadedList;
            this.$.status.innerHTML = 'Uploading...';
            var f;
            for (var i = 0; f = files[i]; i++) {
                var uploader = new MediaUploader({
                    file: f,
                    token: this.accessToken,
                    onComplete: function(data) {
                        uploadedList.push(JSON.parse(data));
                        this.$.status.innerHTML = 'Upload successful';
                        this.uploadList = [];
                    }.bind(this)
                });
                uploader.upload();
            }
        },
        manualUpload: function() {
            this.uploadFiles(this.queue);
        },
        selectFiles: function(files) {
            this.queue = files;
            var f;
            for (var i = 0; f = files[i]; i++) {
                this.uploadList.push(f);
            }
        },
        languageChanged: function() {
            console.log(this.language.value);
        },
        toggleDrawer: function() {
            this.$.drawerPanel.togglePanel();
        },
    });
    </script>
</polymer-element>
